<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Movie Search</title>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="navbar.css">
    <link rel="stylesheet" href="homestyle.css">

	<style>
		.container {
			margin: 20px;
		}
		input[type=text] {
			padding: 10px;
			width: 50%;
			font-size: 18px;
			border-radius: 5px;
			border: none;
			margin-right: 10px;
		}
		button {
			padding: 10px;
			font-size: 18px;
			border-radius: 5px;
			border: none;
			background-color: #008CBA;
			color: white;
		}
		.poster {
			margin-top: 20px;
		}
		.poster img {
			width: 200px;
			height: 300px;
			object-fit: cover;
			margin-right: 20px;
			float: left;
		}
		.overview {
			margin-top: 20px;
		}
	</style>
</head>
<body>
    <div id="navbar"></div>
	<div class="container">
		<h1>Movie Search</h1>
		<form>
			<label for="search">Search by movie name:</label>
			<input type="text" id="search" name="search">
			<button type="button" onclick="searchMovies()">Search</button>
		</form>
		<div class="poster">
			<img id="poster" src="">
			<div class="overview">
				<h2 id="title"></h2>
				<p id="overview"></p>
				<p id="release"></p>
			</div>
		</div>
	</div>

	<script>
		function searchMovies() {
			const url = `http://localhost:3000/movies?query=${document.getElementById("search").value}`;
			$.get(url, function(data) {
				if (data.error) {
					alert(data.error);
				} else {
					document.getElementById("poster").src = data.poster_path;
                    document.getElementById("title").innerHTML = data.title;
                    document.getElementById("overview").innerHTML = data.overview;
                    document.getElementById("release").innerHTML = data.release_date;

                    // Remove any existing favorite button before appending a new one
                    const existingButton = document.getElementById("favorite-button");
                    if (existingButton) {
                        existingButton.remove();
                    }

                    // Create a new button element
                    const favoriteButton = document.createElement("button");
                    favoriteButton.innerHTML = "Add to Favorites";
                    favoriteButton.id = "favorite-button";

                    // Add an event listener to the button that stores the name of the movie
                    favoriteButton.addEventListener("click", function() {
                        const movieName = data.title;
                        storeFavoriteMovie(movieName);
                    });

                    // Pass the name of the movie to the function using a data attribute
                    favoriteButton.setAttribute("data-movie-name", data.title);

                    // Add the button element to the page
                    document.querySelector(".poster").appendChild(favoriteButton);
				}
			});
		}
        function storeFavoriteMovie(movieName) {
            // Call your function to store the name of the movie here
            // somehow store info in a collection : future 
            console.log(`Adding ${movieName} to favorites!`);
        }
	</script>

<script src="loadnavbar.js"></script>
</body>
</html>
